---
title:  DDD没那么难之Specification模式
category: Ramblings
layout: post

---

![header](/images/src-test-groovy/groovy-java.png)    



## 要点

- 领域驱动设计
- 传统的领域驱动设计构建块上手难度较高，不易入门
- Specification模式简单易懂，值得一试

### 为什么我们要尝试领域驱动设计

> **领域驱动设计**(Domain-driven design，缩写 **DDD**)是一种通过将实现连接到持续进化的模型来满足复杂需求的软件开发方法
>
> ​																				——维基百科

软件的目标是解决问题，只有找准问题、理解问题，才能找到更快、更好的解决方案。软件交付团队往往对问题所处领域不熟悉，持续快速地学习、运用领域知识成为交付优秀软件的最大挑战。领域驱动设计是近年来热门的软件开发过程，它承认软件交付的本质是一个学习过程。它要求软件开发中的各种角色使用一种通用语言交流，澄清领域问题，并依此提出解决方案。通过各种敏捷开发实践使技术实现与通用语言保持一致，以便各个角色可以无障碍地沟通，快速、灵活地演进软件。

自2004年领域驱动设计一经提出后，其理念层面可谓是高歌猛进，受到业界的广泛认可。比如《测试驱动的书》，比如spring stero type(repository而不是Dao)，



在实现层面，《[领域驱动设计：软件核心复杂性应对之道](https://www.amazon.cn/%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1-%E8%BD%AF%E4%BB%B6%E6%A0%B8%E5%BF%83%E5%A4%8D%E6%9D%82%E6%80%A7%E5%BA%94%E5%AF%B9%E4%B9%8B%E9%81%93-%E5%9F%83%E6%96%87%E6%96%AF/dp/B004BA21U2?ie=UTF8&*Version*=1&*entries*=0)》一书中提到了聚合根、值对象、实体、领域服务等构造块，但并没有详细说明如何使用它们，针对这一问题，2010年出版的《[实现领域驱动设计](https://book.douban.com/subject/25844633/)》尝试向业界解释这些构造块的使用方法和最佳实践，并且附上了示例代码，但我们还是经常能在项目中听到各种争论。



付款是聚合根还是最对象？
如果付款是聚合根的话，我们能不能同时更新它的金额和订单的已收款金额？这样是不是违反了同一个事物应该只修改一个聚合根的规则？噢，应该用最终一致性，应该通过事件来传递，但是我们还没有对应的基础设置怎么办？



有人说，DDD缺乏一个框架，所以很难落地。比如spring就很容易落地，把DDD限制在了构建块层面



回到领域驱动设计模型与实现保持一致的倡议，重构都是从微小的改动开始的，量变到质变



### 引入Specification模式

介绍



案例

Invoice

复用

谓词

查询



### 总结





